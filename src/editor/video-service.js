window.videoIdCount=100,window.youtubeRegexPattern=/(?:https?:\/\/)?(?:www\.)?youtu(?:\.be\/|be.com\/\S*(?:watch|embed)(?:(?:(?=\/[^&\s\?]+(?!\S))\/)|(?:\S*v=|v\/)))([^&\s\?]+)/.source,window.fetchVideo=async(e,t)=>{try{const t=await fetch(`https://www.youtube.com/get_video_info?video_id=${e}`,{headers:{origin:"https://www.youtube.com"}}),i=await t.text(),o=new URLSearchParams(i).get("player_response"),{videoDetails:a}=JSON.parse(o);return{id:window.videoIdCount++,videoId:e,url:"https://www.youtube.com/watch?v="+e,title:a.title,channel:a.author,thumbnailUrl:"https://i.ytimg.com/vi/"+e+"/default.jpg"}}catch(i){return 2===t?(console.log(i),null):await window.fetchVideo(e,t?t++:1)}},window.parseYoutubeId=e=>{const t=RegExp(window.youtubeRegexPattern,"i").exec(e);return t&&t.length>1?t[1]:null},window.parseYoutubeIds=e=>{let t,i=[];const o=RegExp(window.youtubeRegexPattern,"ig");for(;t=o.exec(e);)i.push(t[1]);return i},window.generatePlaylist=async e=>{const t=await window.generatePlaylistId(),i=new Date;return{id:t,title:i.toLocaleString(),videos:e||[],timestamp:i.getTime()}},window.openPlaylistEditor=e=>{const t=location.hash.length>0?location.hash.substring(1):"/";history.pushState({playlist:e,previousPage:t},"","#/editor"),window.dispatchEvent(new Event("hashchange"))};window.openPlaylist=async e=>{const t=[...e],i=new Array(Math.ceil(t.length/50)).fill().map((e=>t.splice(0,50))),o=await window.getSettings();await Promise.all(i.map((async e=>{var t="https://www.youtube.com/watch_videos?video_ids="+e.join(",");if(o.openPlaylistPage){const e=await(await fetch(t)).text(),i=/og:video:url[^>]+\?list=([^"']+)/.exec(e);i&&i.length>1?t="https://www.youtube.com/playlist?list="+i[1]:alert("Unable to retrieve playlist id. Directly playing videos instead...")}if("undefined"!=typeof browser)return browser.tabs.create({url:t});window.open(t,"_blank")})))};
