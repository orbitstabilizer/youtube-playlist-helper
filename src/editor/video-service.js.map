{"version":3,"file":"video-service.js","sources":["../../playlist-editor/src/services/video-service.ts"],"sourcesContent":["/// <reference path=\"../types/services.d.ts\" />\r\nconst YOUTUBE_URL_PREFIX = \"https://www.youtube.com/watch?v=\";\r\nconst THUMBNAIL_URL_PREFIX = \"https://i.ytimg.com/vi/\";\r\nconst THUMBNAIL_URL_SUFFIX = \"/default.jpg\";\r\nconst youtubeServiceURL = globalThis.youtubeServiceURL;\r\nlet idCount = 100;\r\n// https://regex101.com/r/mPyKKP/1/\r\nwindow.youtubeRegexPattern = /(?:https?:\\/\\/)?(?:www\\.)?youtu(?:\\.be\\/|be.com\\/\\S*(?:watch|embed)(?:(?:(?=\\/[^&\\s\\?]+(?!\\S))\\/)|(?:\\S*v=|v\\/)))([^&\\s\\?]+)/.source;\r\nwindow.fetchVideo = async (videoId) => {\r\n    const res = await fetch(`${youtubeServiceURL}/get_video_info?video_id=${videoId}`, {\r\n        headers: { origin: \"https://www.youtube.com\" },\r\n    });\r\n    const text = await res.text();\r\n    const playerRes = new URLSearchParams(text).get(\"player_response\");\r\n    const { videoDetails } = JSON.parse(playerRes);\r\n    return {\r\n        id: idCount++,\r\n        videoId,\r\n        url: YOUTUBE_URL_PREFIX + videoId,\r\n        title: videoDetails.title,\r\n        channel: videoDetails.author,\r\n        thumbnailUrl: THUMBNAIL_URL_PREFIX + videoId + THUMBNAIL_URL_SUFFIX,\r\n    };\r\n};\r\n/**\r\n * @param  {string} url\r\n */\r\nwindow.parseYoutubeId = (url) => {\r\n    const result = RegExp(window.youtubeRegexPattern, \"i\").exec(url);\r\n    if (result && result.length > 1) {\r\n        return result[1];\r\n    }\r\n    return null;\r\n};\r\nexport {};\r\n"],"names":["idCount","window","youtubeRegexPattern","source","fetchVideo","async","videoId","res","fetch","headers","origin","text","playerRes","URLSearchParams","get","videoDetails","JSON","parse","id","url","title","channel","author","thumbnailUrl","parseYoutubeId","result","RegExp","exec","length"],"mappings":"AAKA,IAAIA,EAAU,IAEdC,OAAOC,oBAAsB,+HAA+HC,OAC5JF,OAAOG,WAAaC,MAAOC,IACvB,MAAMC,QAAYC,MAAM,mDAAgDF,IAAW,CAC/EG,QAAS,CAAEC,OAAQ,6BAEjBC,QAAaJ,EAAII,OACjBC,EAAY,IAAIC,gBAAgBF,GAAMG,IAAI,oBAC1CC,aAAEA,GAAiBC,KAAKC,MAAML,GACpC,MAAO,CACHM,GAAIlB,IACJM,QAAAA,EACAa,IAjBmB,mCAiBOb,EAC1Bc,MAAOL,EAAaK,MACpBC,QAASN,EAAaO,OACtBC,aAnBqB,0BAmBgBjB,EAlBhB,iBAwB7BL,OAAOuB,eAAkBL,IACrB,MAAMM,EAASC,OAAOzB,OAAOC,oBAAqB,KAAKyB,KAAKR,GAC5D,OAAIM,GAAUA,EAAOG,OAAS,EACnBH,EAAO,GAEX"}